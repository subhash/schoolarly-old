<div class="breadcrumbs"><%= ancestor_path_for(@group) %></div>
<div class="detail detail1">
  <div class="image"><%= link_to image_for_group(@group, 'medium', :class=>"img"), group_path(@group) %></div>
  <div class="title"><%= link_to @group.name, group_path(@group) %></div>
  <div class="subtitle"><%= I18n.t('tog_social.groups.model.created_at') %> <%= @group.created_at.strftime("%d/%m/%Y") %>, <%= I18n.t('tog_social.groups.model.members', :count => @group.members.size) %></div>
  <div class="summary"><%= I18n.t('tog_social.groups.model.moderated_by') %>:
    <% for moderator in @group.moderators -%>
      <%=link_to moderator.profile.full_name, profile_path(moderator.profile), :class=> 'maincolor4'%>
    <% end -%>
    <br/>
    <%= I18n.t('tog_social.tags.tags') %>: 
      <% for tag in @group.tag_list %>
        <%= link_to tag.to_s, tag_groups_path(tag) %>
      <% end %>   
  </div>
  <div class="text">
    <p><%= @group.description %></p>
  </div>
</div> <!-- /.detail1 --> 

<% if i_am_member_of @group %>
<div class="portlet portletB">
    <h2><span><%= I18n.t('tog_conversatio.views.blogs.show.last_posts') %></span></h2>

    <div class="portlet_content">
        <ul>
              <% for share in @sharings %>
			  <% if share.shareable.is_a? Post %>
                <%= render :partial => '/conversatio/posts/list_detail', :locals => { :blog => share.shareable.blog, :post => share.shareable } %>
			  <% end %>
              <% end %>
        </ul>
    </div>
</div>

<% if !@sharings.empty? %>
  <div class="info_results">
      <span class="info_items">
        <%= page_entries_info @sharings %>
      </span>
      <span class="pages_navigation right">
          <%= will_paginate @sharings %>
      </span>
  </div>
<%end%>

<% end %>

<% content_for :sidebar do %>

<div class="portlet portletC" id="portlet_moreLinks">
    <h2><span><%= I18n.t('tog_social.more_links') %></span></h2>
    <div class="portlet_content">
        <ul>
          <% if i_am_member_of @group -%>
            <li><%= I18n.t('tog_social.groups.site.member') %><%= link_to I18n.t('tog_social.groups.site.leave'), leave_group_path(@group), :confirm => I18n.t('tog_social.groups.site.leave_confirm'), :class => 'delete' %></li>
			<li><%= link_to I18n.t('groups.member.post.create'), new_member_conversatio_blog_post_url(current_user.default_blog, :group => @group) %></li>
          <% else -%>
            <li><%= link_to I18n.t('tog_social.groups.site.join'), join_group_path(@group), :class => 'add' %></li>
          <% end -%> 
		  <% if i_am_moderator_of @group -%> 
		  <% if @group.school? %>
		    <li><%= link_to I18n.t('klasses.site.create'), member_new_sub_group_path(@group.id, :type => 'klasses'), :class => 'add' %></li>
		    <li><%= link_to I18n.t('schools.site.admin.invite'), select_member_group_path(@group), :class => 'add' %></li>
		    <li><%= link_to I18n.t('groups.site.Teacher.invite'), new_member_group_teacher_path(@group), :class => 'add' %></li>
		    <li><%= link_to I18n.t('groups.site.Student.invite'), new_member_group_student_path(@group), :class => 'add' %></li>
		  <% else %>
		    <li><%= link_to I18n.t('groups.site.add.Teacher'), select_member_group_path(@group, :type => 'Teacher'), :class => 'add' %></li>
		    <li><%= link_to I18n.t('groups.site.add.Student'), select_member_group_path(@group, :type => 'Student'), :class => 'add' %></li>						
			<li><%= link_to I18n.t('groups.member.sub_groups.create'), member_new_sub_group_path(@group.id), :class => 'add' %></li>
		  <% end %>
		  <% if @group.klass? %>
		    <li><%= link_to I18n.t('subjects.site.create'), member_new_sub_group_path(@group.id, :type => 'subjects'), :class => 'add' %></li>
		  <% end %>
		  <% end %>
        </ul>
    </div> 
</div>    

<% @group.users.group_by(&:type).each do |type, users| %>
	<%= render :partial => "shared/profiles_portlet", :locals => { 
	  :items => users.collect(&:profile), 
	  :style => :portletG, 
	  :title => I18n.t("groups.model.#{type}.title", :count => @group.members.size),  
	  :no_items => I18n.t('tog_social.groups.model.members_not_found', :group_name => @group.name) } %>
 <% end %>
 
<% @group.children.group_by(&:type).each do |type, groups| %>
	<%= render :partial => "groups_portlet", :locals => { 
	:items => groups, 
	:style => :portletG, 
	:title => I18n.t("groups.model.#{type}.title"),  
	:no_items => I18n.t('groups.model.groups_not_found', :parent => @group.name) } %> 
<% end %>
<% end %>

