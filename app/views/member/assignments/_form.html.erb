<% include_mootools_datepicker %>
<%= include_tiny_mce_if_needed %>
<% include_form_effects %>
<% include_stylesheet 'rubric' %>
<% include_javascript "busy_ajax_jquery" %>
<script type="text/javascript">
    jQuery.noConflict();
    
    jQuery(document).ready(function(){
        new DatePicker('.date_with_time', {
            timePicker: true,
            format: 'd-m-Y @ h:i a',
            dayShort: 3,
            inputOutputFormat: 'Y-m-d H:i',
            minDate: {
                date: "<%= Date.today.to_s %>",
                format: 'Y-m-d'
            }
        });
        new DatePicker('.date_without_time', {
            timePicker: false,
            format: 'd-m-Y',
            inputOutputFormat: 'Y-m-d',
        });
        new DatePicker('.time_only', {
            timePickerOnly: true,
            format: 'H:i',
            inputOutputFormat: 'Y-m-d H:i',
        });
    });
</script>
<% f.fields_for :post do |p| %>
<%= render :partial => 'member/conversatio/posts/form', :locals => {:f => p} %>
<%= hidden_field_tag :group, @group.id if @group %>
<%= hidden_field_tag 'post_state', I18n.t('tog_conversatio.model.states.published') %>
<% if local_assigns[:publish] and publish %>
<div class="fields">
    <p>
        <label for="starts_at">
            <%= I18n.t('assignments.model.publish_at') %>
        </label>
        <%= p.text_field :published_at,  :class => "date_with_time" %>
        <br/>
    </p>
</div>
<% end %>
<% end %>
<div class="fields">
    <p>
        <label for="assignment_score">
            <%= I18n.t('assignments.member.new.score') %>
        </label>
        <%= f.text_field :score -%>
    </p>
</div>
<div class="fields">
    <div class="p">
        <%= render :partial => 'member/rubrics/choose_rubric', :locals => {:action => 'show' , :title => I18n.t('assignments.member.rubric.attach')} %>
        <div id='rubric'>
        </div>
    </div>
</div>
